/*!
 * Midnight.js 1.2.0
 * jQuery plugin to switch between multiple fixed header designs on the fly, so it looks in line with the content below it.
 * http://aerolab.github.io/midnight.js/
 *
 * Copyright (c) 2014 Aerolab <info@aerolab.co>
 *
 * Released under the MIT license
 * http://aerolab.github.io/midnight.js/LICENSE.txt
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(d){var o,s=0,a=Array.prototype.slice;d.cleanData=(o=d.cleanData,function(t){for(var e,s,i=0;null!=(s=t[i]);i++)try{(e=d._data(s,"events"))&&e.remove&&d(s).triggerHandler("remove")}catch(t){}o(t)}),d.widget=function(t,s,e){var i,o,n,r,a={},h=t.split(".")[0];return t=t.split(".")[1],i=h+"-"+t,e||(e=s,s=d.Widget),d.expr[":"][i.toLowerCase()]=function(t){return!!d.data(t,i)},d[h]=d[h]||{},o=d[h][t],n=d[h][t]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new n(t,e)},d.extend(n,o,{version:e.version,_proto:d.extend({},e),_childConstructors:[]}),(r=new s).options=d.widget.extend({},r.options),d.each(e,function(e,i){return d.isFunction(i)?void(a[e]=function(){var t,e=this._super,s=this._superApply;return this._super=o,this._superApply=n,t=i.apply(this,arguments),this._super=e,this._superApply=s,t}):void(a[e]=i);function o(){return s.prototype[e].apply(this,arguments)}function n(t){return s.prototype[e].apply(this,t)}}),n.prototype=d.widget.extend(r,{widgetEventPrefix:o&&r.widgetEventPrefix||t},a,{constructor:n,namespace:h,widgetName:t,widgetFullName:i}),o?(d.each(o._childConstructors,function(t,e){var s=e.prototype;d.widget(s.namespace+"."+s.widgetName,n,e._proto)}),delete o._childConstructors):s._childConstructors.push(n),d.widget.bridge(t,n),n},d.widget.extend=function(t){for(var e,s,i=a.call(arguments,1),o=0,n=i.length;o<n;o++)for(e in i[o])s=i[o][e],i[o].hasOwnProperty(e)&&void 0!==s&&(t[e]=d.isPlainObject(s)?d.isPlainObject(t[e])?d.widget.extend({},t[e],s):d.widget.extend({},s):s);return t},d.widget.bridge=function(n,e){var r=e.prototype.widgetFullName||n;d.fn[n]=function(s){var t="string"==typeof s,i=a.call(arguments,1),o=this;return s=!t&&i.length?d.widget.extend.apply(null,[s].concat(i)):s,t?this.each(function(){var t,e=d.data(this,r);return"instance"===s?(o=e,!1):e?d.isFunction(e[s])&&"_"!==s.charAt(0)?(t=e[s].apply(e,i))!==e&&void 0!==t?(o=t&&t.jquery?o.pushStack(t.get()):t,!1):void 0:d.error("no such method '"+s+"' for "+n+" widget instance"):d.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+s+"'")}):this.each(function(){var t=d.data(this,r);t?(t.option(s||{}),t._init&&t._init()):d.data(this,r,new e(s,this))}),o}},d.Widget=function(){},d.Widget._childConstructors=[],d.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,e){e=d(e||this.defaultElement||this)[0],this.element=d(e),this.uuid=s++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=d(),this.hoverable=d(),this.focusable=d(),e!==this&&(d.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=d(e.style?e.ownerDocument:e.document||e),this.window=d(this.document[0].defaultView||this.document[0].parentWindow)),this.options=d.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:d.noop,_getCreateEventData:d.noop,_create:d.noop,_init:d.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(d.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:d.noop,widget:function(){return this.element},option:function(t,e){var s,i,o,n=t;if(0===arguments.length)return d.widget.extend({},this.options);if("string"==typeof t)if(n={},t=(s=t.split(".")).shift(),s.length){for(i=n[t]=d.widget.extend({},this.options[t]),o=0;s.length-1>o;o++)i[s[o]]=i[s[o]]||{},i=i[s[o]];if(t=s.pop(),1===arguments.length)return void 0===i[t]?null:i[t];i[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];n[t]=e}return this._setOptions(n),this},_setOptions:function(t){for(var e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(o,n,t){var r,a=this;"boolean"!=typeof o&&(t=n,n=o,o=!1),t?(n=r=d(n),this.bindings=this.bindings.add(n)):(t=n,n=this.element,r=this.widget()),d.each(t,function(t,e){function s(){return o||!0!==a.options.disabled&&!d(this).hasClass("ui-state-disabled")?("string"==typeof e?a[e]:e).apply(a,arguments):void 0}"string"!=typeof e&&(s.guid=e.guid=e.guid||s.guid||d.guid++);var t=t.match(/^([\w:-]*)\s*(.*)$/),i=t[1]+a.eventNamespace,t=t[2];t?r.delegate(t,i,s):n.bind(i,s)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e),this.bindings=d(this.bindings.not(t).get()),this.focusable=d(this.focusable.not(t).get()),this.hoverable=d(this.hoverable.not(t).get())},_delay:function(t,e){var s=this;return setTimeout(function(){return("string"==typeof t?s[t]:t).apply(s,arguments)},e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){d(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){d(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){d(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){d(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,e,s){var i,o,n=this.options[t];if(s=s||{},(e=d.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],o=e.originalEvent)for(i in o)i in e||(e[i]=o[i]);return this.element.trigger(e,s),!(d.isFunction(n)&&!1===n.apply(this.element[0],[e].concat(s))||e.isDefaultPrevented())}},d.each({show:"fadeIn",hide:"fadeOut"},function(n,r){d.Widget.prototype["_"+n]=function(e,t,s){var i=(t="string"==typeof t?{effect:t}:t)?!0!==t&&"number"!=typeof t&&t.effect||r:n,o=!d.isEmptyObject(t="number"==typeof(t=t||{})?{duration:t}:t);t.complete=s,t.delay&&e.delay(t.delay),o&&d.effects&&d.effects.effect[i]?e[n](t):i!==n&&e[i]?e[i](t.duration,t.easing,s):e.queue(function(t){d(this)[n](),s&&s.call(e[0]),t()})}}),d.widget}),function(r){"use strict";r.widget("aerolab.midnight",{options:{headerClass:"midnightHeader",innerClass:"midnightInner",defaultClass:"default",classPrefix:"",sectionSelector:"midnight",axis:"Y"},_headers:{},_headerInfo:{top:0,height:0,left:0,width:0},_$sections:[],_sections:[],_scrollTop:0,_documentHeight:0,_scrollLeft:0,_documentWidth:0,_transformMode:!1,refresh:function(){this._headerInfo={top:0,height:this.element.outerHeight(),left:0,width:this.element.outerWidth()},this._$sections=r("[data-"+this.options.sectionSelector+"]:not(:hidden)"),this._sections=[],this._setupHeaders(),this.recalculate()},_create:function(){var t=this;this._scrollTop=window.pageYOffset||document.documentElement.scrollTop,this._scrollLeft=window.pageXOffset||document.documentElement.scrollLeft,this._documentHeight=r(document).height(),this._documentWidth=r(document).width(),this._headers={},this._transformMode=this._getSupportedTransform(),this.refresh(),setInterval(function(){t._recalculateSections()},1e3),t.recalculate(),r(window).resize(function(){t.recalculate()}),this._updateHeadersLoop()},recalculate:function(){this._recalculateSections(),this._updateHeaderHeight(),this._recalculateHeaders(),this._updateHeaders()},_getSupportedTransform:function(){for(var t=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=0;e<t.length;e++)if(void 0!==document.createElement("div").style[t[e]])return t[e];return!1},_getContainerDimension:function(){var t=this.element.find("> ."+this.options.headerClass),s=0,i=0,o=this;return t.length?t.each(function(){var t=r(this),e=t.find("> ."+o.options.innerClass);e.length?"Y"===o.options.axis?(e.css("bottom","auto").css("overflow","auto"),i=e.outerHeight(),e.css("bottom","0")):(e.css("right","auto").css("overflow","auto"),i=e.outerWidth(),e.css("right","0")):"Y"===o.options.axis?(t.css("bottom","auto"),i=t.outerHeight(),t.css("bottom","0")):(t.css("right","auto"),i=t.outerWidth(),t.css("right","0")),s=s<i?i:s}):s=i="Y"===this.options.axis?this.element.outerHeight():this.element.outerWidth(),s},_setupHeaders:function(){var i=this;this._headers[this.options.defaultClass]={};for(var t=0;t<this._$sections.length;t++)"string"==typeof(s=r(this._$sections[t]).data(this.options.sectionSelector))&&""!==(s=s.trim())&&(i._headers[s]={});this.element.css({position:"fixed",top:0,left:0,right:0,bottom:0,overflow:"hidden"}),this._updateHeaderHeight();var e=this.element.find("> ."+this.options.headerClass);e.length?e.filter("."+this.options.defaultClass).length||e.filter("."+this.options.headerClass+":first").clone(!0,!0).attr("class",this.options.headerClass+" "+this.options.defaultClass):this.element.wrapInner('<div class="'+this.options.headerClass+" "+this.options.defaultClass+'"></div>');var s,o,n=(e=this.element.find("> ."+this.options.headerClass)).filter("."+this.options.defaultClass).clone(!0,!0);for(s in this._headers)this._headers.hasOwnProperty(s)&&void 0===this._headers[s].element&&((o=e.filter("."+s)).length?this._headers[s].element=o:this._headers[s].element=n.clone(!0,!0).removeClass(this.options.defaultClass).addClass(s).appendTo(this.element),this._headers[s].element.css(o={position:"absolute",overflow:"hidden",top:0,left:0,right:0,bottom:0}),!1!==this._transformMode&&this._headers[s].element.css(this._transformMode,"translateZ(0)"),this._headers[s].element.find("> ."+this.options.innerClass).length||this._headers[s].element.wrapInner('<div class="'+this.options.innerClass+'"></div>'),this._headers[s].inner=this._headers[s].element.find("> ."+this.options.innerClass),this._headers[s].inner.css(o),!1!==this._transformMode&&this._headers[s].inner.css(this._transformMode,"translateZ(0)"),this._headers[s].from="",this._headers[s].progress=0);e.each(function(){var t,e=r(this),s=!1;for(t in i._headers)i._headers.hasOwnProperty(t)&&e.hasClass(t)&&(s=!0);e.find("> ."+i.options.innerClass).length||e.wrapInner('<div class="'+i.options.innerClass+'"></div>'),s?e.show():e.hide()})},_recalculateHeaders:function(){this._scrollTop=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,this._scrollLeft=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,this._scrollTop=Math.max(this._scrollTop,0),this._scrollTop=Math.min(this._scrollTop,this._documentHeight),this._scrollLeft=Math.max(this._scrollLeft,0),this._scrollLeft=Math.min(this._scrollLeft,this._documentWidth);var t,e,s,i,o,n,r=this._headerInfo.height,a=this._scrollTop+this._headerInfo.top,h=a+r,d=this._headerInfo.width;for(n in"X"===this.options.axis&&(h=(a=this._scrollLeft+this._headerInfo.left)+d),"function"==typeof window.getComputedStyle&&(t=window.getComputedStyle(this.element[0],null),s=e=o=0,o="Y"===this.options.axis?t.top:t.left,!1!==this._transformMode&&"string"==typeof t.transform&&null!==(i=t.transform.match(/(-?[0-9\.]+)/g))&&6<=i.length&&!isNaN(parseFloat(i[5]))&&(s=parseFloat(i[5])),0<=t.top.indexOf("%")&&!isNaN(parseFloat(o))?e=("Y"===this.options.axis?window.innerHeight:window.innerWidth)*(parseFloat(o)/100):0<=o.indexOf("px")&&!isNaN(parseFloat(o))&&(e=parseFloat("Y"===this.options.axis?t.top:t.left)),a+=e+s,h+=e+s),this._headers)this._headers.hasOwnProperty(n)&&(this._headers[n].from="",this._headers[n].progress=0);for(var l=0;l<this._sections.length;l++)h>=this._sections[l].start&&a<=this._sections[l].end&&(this._headers[this._sections[l].className].visible=!0,a>=this._sections[l].start&&h<=this._sections[l].end?(this._headers[this._sections[l].className].from="Y"===this.options.axis?"top":"left",this._headers[this._sections[l].className].progress+=1):h>this._sections[l].end&&a<this._sections[l].end?(this._headers[this._sections[l].className].from="Y"===this.options.axis?"top":"left",this._headers[this._sections[l].className].progress=1-(h-this._sections[l].end)/("Y"===this.options.axis?r:d)):h>this._sections[l].start&&a<this._sections[l].start&&(this._headers[this._sections[l].className].from===("Y"===this.options.axis?"top":"left")?this._headers[this._sections[l].className].progress+=(h-this._sections[l].start)/("Y"===this.options.axis?r:d):(this._headers[this._sections[l].className].from="Y"===this.options.axis?"bottom":"right",this._headers[this._sections[l].className].progress=(h-this._sections[l].start)/("Y"===this.options.axis?r:d))))},_updateHeaders:function(){if(void 0!==this._headers[this.options.defaultClass]){var t,e,s,i,o,n=0,r="";for(t in this._headers)this._headers.hasOwnProperty(t)&&""!==!this._headers[t].from&&(n+=this._headers[t].progress,r=t);for(s in n<1&&(""===this._headers[this.options.defaultClass].from?(e="top"===this._headers[r].from?"bottom":"top","X"===this.options.axis&&(e="left"===this._headers[r].from?"right":"left"),this._headers[this.options.defaultClass].from=e,this._headers[this.options.defaultClass].progress=1-n):this._headers[this.options.defaultClass].progress+=1-n),this._headers)this._headers.hasOwnProperty(s)&&""!==!this._headers[s].from&&((i=100<=(i=100*(1-this._headers[s].progress))?110:i)<=-100&&(i=-110),o="Y"===this.options.axis?"top":"left",this._headers[s].from===o?!1!==this._transformMode?(this._headers[s].element[0].style[this._transformMode]="translate"+this.options.axis+"(-"+i+"%) translateZ(0)",this._headers[s].inner[0].style[this._transformMode]="translate"+this.options.axis+"(+"+i+"%) translateZ(0)"):(this._headers[s].element[0].style[o]="-"+i+"%",this._headers[s].inner[0].style[o]="+"+i+"%"):!1!==this._transformMode?(this._headers[s].element[0].style[this._transformMode]="translate"+this.options.axis+"(+"+i+"%) translateZ(0)",this._headers[s].inner[0].style[this._transformMode]="translate"+this.options.axis+"(-"+i+"%) translateZ(0)"):(this._headers[s].element[0].style[o]="+"+i+"%",this._headers[s].inner[0].style[o]="-"+i+"%"))}},_recalculateSections:function(){this._documentHeight=r(document).height(),this._documentWidth=r(document).width(),this._sections=[];for(var t=0;t<this._$sections.length;t++){var e=r(this._$sections[t]);this._sections.push({element:e,className:e.data(this.options.sectionSelector),start:"Y"===this.options.axis?e.offset().top:e.offset().left,end:("Y"===this.options.axis?e.offset().top:e.offset().left)+("Y"===this.options.axis?e.outerHeight():e.outerWidth())})}},_updateHeaderHeight:function(){"Y"===this.options.axis?(this._headerInfo.height=this._getContainerDimension(),this.element.css("height",this._headerInfo.height+"px")):(this._headerInfo.width=this._getContainerDimension(),this.element.css("width",this._headerInfo.width+"px"))},_updateHeadersLoop:function(){var t=this;this._requestAnimationFrame(function(){t._updateHeadersLoop()}),this._recalculateHeaders(),this._updateHeaders()},_requestAnimationFrame:function(t){(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})(t)}})}(jQuery);